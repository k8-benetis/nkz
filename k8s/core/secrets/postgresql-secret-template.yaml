# =============================================================================
# Secret Template para Credenciales de PostgreSQL/TimescaleDB
# =============================================================================
# IMPORTANTE: Este archivo es solo un TEMPLATE
# NO incluir valores reales en Git
# 
# Para crear el Secret real en el servidor, ejecutar:
# kubectl create secret generic postgresql-secret \
#   --from-literal=password='TU_CONTRASEÑA_POSTGRES' \
#   --from-literal=postgres-url='postgresql://nekazari:TU_CONTRASEÑA@postgresql-service:5432/nekazari' \
#   -n nekazari
#
# O usar el script: scripts/create-postgresql-secret.sh
#
# NOTA: El usuario 'nekazari' debe existir en PostgreSQL.
# Si no existe, crearlo con:
# kubectl exec -it deployment/postgresql -n nekazari -- psql -U postgres -c "CREATE USER nekazari WITH PASSWORD 'TU_CONTRASEÑA';"
# kubectl exec -it deployment/postgresql -n nekazari -- psql -U postgres -c "GRANT ALL PRIVILEGES ON DATABASE nekazari TO nekazari;"
#
# IMPORTANTE: También necesitas crear el bootstrap-secret antes del primer despliegue:
# kubectl create secret generic bootstrap-secret \
#   --from-literal=admin-email='admin@tudominio.com' \
#   --from-literal=admin-password='TU_CONTRASEÑA_FUERTE_123!' \
#   -n nekazari
# Ver: k8s/k3s-optimized/bootstrap-secret-template.yaml
apiVersion: v1
kind: Secret
metadata:
  name: postgresql-secret
  namespace: nekazari
  labels:
    app: postgresql
    component: database
type: Opaque
stringData:
  # Contraseña de PostgreSQL (usada por el deployment de PostgreSQL)
  password: "REPLACE_WITH_POSTGRES_PASSWORD"
  
  # URL completa de conexión a PostgreSQL (usada por servicios como risk-api, tenant-webhook)
  # Formato: postgresql://usuario:contraseña@host:puerto/base_de_datos
  # IMPORTANTE: El usuario debe existir en PostgreSQL (ver notas arriba)
  postgres-url: "postgresql://nekazari:REPLACE_WITH_POSTGRES_PASSWORD@postgresql-service:5432/nekazari"
  
  # Campos adicionales para compatibilidad (opcionales)
  POSTGRES_USER: "nekazari"
  POSTGRES_DB: "nekazari"
  POSTGRES_HOST: "postgresql-service"
  POSTGRES_PORT: "5432"

